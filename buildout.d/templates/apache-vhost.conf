<VirtualHost *:${ports:http}>
	ServerName ${hosts:public}
	#ServerAlias jcrtest
	ServerAdmin webmaster@${hosts:public}

	AADefaultHatName Apache2Vhost_${hosts:public}

	CustomLog /var/log/apache2/${hosts:public}-access_log combined
	ErrorLog /var/log/apache2/${hosts:public}-error_log

	# prevent the webserver from being used as proxy
	<LocationMatch "^[^/]">
		Deny from all
	</LocationMatch>

	ProxyVia On
	ProxyPass        / http://${hosts:apache-backend}:${ports:apache-backend}/VirtualHostBase/http/${hosts:public}:${ports:http}/${sites:main}/VirtualHostRoot/
	ProxyPassReverse / http://${hosts:apache-backend}:${ports:apache-backend}/VirtualHostBase/http/${hosts:public}:${ports:http}/${sites:main}/VirtualHostRoot/
	ProxyPreserveHost On

	# By default, all requests are taken from this directory, but symbolic
	# links and aliases may be used to point to other locations.
	DocumentRoot /srv/www/vhosts/${hosts:public}/htdocs
	<Directory "/srv/www/vhosts/${hosts:public}/htdocs">
		AllowOverride All
		Order allow,deny
		Allow from all
	</Directory>
</VirtualHost>

<IfDefine SSL>
<IfDefine !NOSSL>
<VirtualHost *:${ports:https}>
	# Enable SSL
	Include /etc/apache2/conf.d/ssl.conf
	ServerName ${hosts:public}

	ServerName ${hosts:public}
	#ServerAlias jcrtest
	ServerAdmin webmaster@${hosts:public}

	AADefaultHatName Apache2Vhost_${hosts:public}

	CustomLog /var/log/apache2/${hosts:public}-access_log combined
	ErrorLog /var/log/apache2/${hosts:public}-error_log

	# prevent the webserver from being used as proxy
	<LocationMatch "^[^/]">
		Deny from all
	</LocationMatch>

	ProxyVia On
	ProxyPass        / http://${hosts:apache-backend}:${ports:apache-backend}/VirtualHostBase/https/${hosts:public}:${ports:https}/${sites:main}/VirtualHostRoot/
	ProxyPassReverse / http://${hosts:apache-backend}:${ports:apache-backend}/VirtualHostBase/https/${hosts:public}:${ports:https}/${sites:main}/VirtualHostRoot/
	ProxyPreserveHost On

	# By default, all requests are taken from this directory, but symbolic
	# links and aliases may be used to point to other locations.
	DocumentRoot /srv/www/vhosts/${hosts:public}/htdocs
	<Directory "/srv/www/vhosts/${hosts:public}/htdocs">
		AllowOverride All
		Order allow,deny
		Allow from all
	</Directory>
</VirtualHost>
</IfDefine>
</IfDefine>
